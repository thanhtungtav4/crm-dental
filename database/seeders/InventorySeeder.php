<?php

namespace Database\Seeders;

use App\Models\Material;
use App\Models\MaterialBatch;
use App\Models\Supplier;
use Illuminate\Database\Seeder;
use Illuminate\Support\Facades\DB;

class InventorySeeder extends Seeder
{
    /**
     * Run the database seeds.
     */
    public function run(): void
    {
        // Get first user for created_by/updated_by
        $userId = DB::table('users')->value('id') ?? 1;

        // Create 5 Vietnamese dental suppliers
        $suppliers = [
            [
                'name' => 'Nha Khoa Viá»‡t Nam',
                'code' => 'NKVN',
                'tax_code' => '0123456789',
                'contact_person' => 'Nguyá»…n VÄƒn A',
                'phone' => '0901234567',
                'email' => 'nkvn@example.com',
                'address' => '123 Nguyá»…n Huá»‡, Q.1, TP.HCM',
                'website' => 'https://nkvn.com.vn',
                'payment_terms' => '30_days',
                'notes' => 'NhÃ  phÃ¢n phá»‘i chÃ­nh thá»©c 3M ESPE táº¡i Viá»‡t Nam',
                'active' => true,
            ],
            [
                'name' => 'Dentsply Vietnam Co., Ltd',
                'code' => 'DPLY',
                'tax_code' => '0987654321',
                'contact_person' => 'Tráº§n Thá»‹ B',
                'phone' => '0902345678',
                'email' => 'dentsply@example.com',
                'address' => '456 LÃª Lá»£i, Q.1, TP.HCM',
                'website' => 'https://dentsply.com',
                'payment_terms' => '15_days',
                'notes' => 'NhÃ  sáº£n xuáº¥t váº­t liá»‡u nha khoa hÃ ng Ä‘áº§u tháº¿ giá»›i',
                'active' => true,
            ],
            [
                'name' => 'NSK Vietnam',
                'code' => 'NSK',
                'tax_code' => '0112233445',
                'contact_person' => 'LÃª VÄƒn C',
                'phone' => '0903456789',
                'email' => 'nsk@example.com',
                'address' => '789 Tráº§n HÆ°ng Äáº¡o, Q.5, TP.HCM',
                'payment_terms' => '7_days',
                'notes' => 'ChuyÃªn cung cáº¥p thiáº¿t bá»‹ nha khoa Nháº­t Báº£n',
                'active' => true,
            ],
            [
                'name' => 'CÃ´ng ty TNHH DÆ°á»£c Pháº©m HÃ  Ná»™i',
                'code' => 'DPHN',
                'tax_code' => '0556677889',
                'contact_person' => 'Pháº¡m Thá»‹ D',
                'phone' => '0904567890',
                'email' => 'dphn@example.com',
                'address' => '321 Hai BÃ  TrÆ°ng, Q.3, TP.HCM',
                'payment_terms' => 'cash',
                'notes' => 'NhÃ  cung cáº¥p thuá»‘c vÃ  dÆ°á»£c pháº©m',
                'active' => true,
            ],
            [
                'name' => 'Sirona Dental Vietnam',
                'code' => 'SIRONA',
                'tax_code' => '0998877665',
                'contact_person' => 'HoÃ ng VÄƒn E',
                'phone' => '0905678901',
                'email' => 'sirona@example.com',
                'address' => '147 Pasteur, Q.1, TP.HCM',
                'website' => 'https://sirona.com',
                'payment_terms' => '60_days',
                'notes' => 'Thiáº¿t bá»‹ nha khoa cao cáº¥p tá»« Äá»©c',
                'active' => true,
            ],
        ];

        foreach ($suppliers as $supplierData) {
            Supplier::firstOrCreate(
                ['code' => $supplierData['code']],
                $supplierData
            );
        }

        $this->command->info('âœ… Created or updated 5 suppliers');

        // Get suppliers for foreign keys
        $supplierIds = Supplier::pluck('id')->toArray();

        // Get first branch for materials
        $branchId = DB::table('branches')->value('id');

        // Create 25 materials across 4 categories
        $materials = [
            // MEDICINE (5 items)
            [
                'sku' => 'MED-001',
                'name' => 'Lidocaine 2% (Há»™p 50 á»‘ng)',
                'category' => 'medicine',
                'manufacturer' => 'Novocol Pharmaceutical',
                'supplier_id' => $supplierIds[3] ?? null,
                'unit' => 'Há»™p',
                'stock_qty' => 15,
                'min_stock' => 5,
                'reorder_point' => 8,
                'cost_price' => 450000,
                'sale_price' => 650000,
                'storage_location' => 'Tá»§ thuá»‘c A1',
                'branch_id' => $branchId,
            ],
            [
                'sku' => 'MED-002',
                'name' => 'Articaine 4% vá»›i Epinephrine',
                'category' => 'medicine',
                'manufacturer' => 'Septodont',
                'supplier_id' => $supplierIds[3] ?? null,
                'unit' => 'Há»™p',
                'stock_qty' => 8,
                'min_stock' => 3,
                'reorder_point' => 5,
                'cost_price' => 580000,
                'sale_price' => 820000,
                'storage_location' => 'Tá»§ thuá»‘c A1',
                'branch_id' => $branchId,
            ],
            [
                'sku' => 'MED-003',
                'name' => 'Amoxicillin 500mg (Há»™p 100 viÃªn)',
                'category' => 'medicine',
                'manufacturer' => 'DHG Pharma',
                'supplier_id' => $supplierIds[3] ?? null,
                'unit' => 'Há»™p',
                'stock_qty' => 20,
                'min_stock' => 10,
                'reorder_point' => 15,
                'cost_price' => 120000,
                'sale_price' => 180000,
                'storage_location' => 'Tá»§ thuá»‘c B2',
                'branch_id' => $branchId,
            ],
            [
                'sku' => 'MED-004',
                'name' => 'Ibuprofen 400mg (Há»™p 100 viÃªn)',
                'category' => 'medicine',
                'manufacturer' => 'Traphaco',
                'supplier_id' => $supplierIds[3] ?? null,
                'unit' => 'Há»™p',
                'stock_qty' => 25,
                'min_stock' => 10,
                'reorder_point' => 15,
                'cost_price' => 85000,
                'sale_price' => 130000,
                'storage_location' => 'Tá»§ thuá»‘c B2',
                'branch_id' => $branchId,
            ],
            [
                'sku' => 'MED-005',
                'name' => 'Hydrogen Peroxide 3% (Chai 500ml)',
                'category' => 'medicine',
                'manufacturer' => 'VÄ©nh PhÃºc',
                'supplier_id' => $supplierIds[3] ?? null,
                'unit' => 'Chai',
                'stock_qty' => 30,
                'min_stock' => 15,
                'reorder_point' => 20,
                'cost_price' => 25000,
                'sale_price' => 45000,
                'storage_location' => 'Tá»§ thuá»‘c C1',
                'branch_id' => $branchId,
            ],

            // CONSUMABLE (8 items)
            [
                'sku' => 'CON-001',
                'name' => 'BÃ´ng cuá»™n (GÃ³i 100g)',
                'category' => 'consumable',
                'manufacturer' => 'Vina Cotton',
                'supplier_id' => $supplierIds[0] ?? null,
                'unit' => 'GÃ³i',
                'stock_qty' => 50,
                'min_stock' => 20,
                'reorder_point' => 30,
                'cost_price' => 35000,
                'sale_price' => 50000,
                'storage_location' => 'Ká»‡ D1',
                'branch_id' => $branchId,
            ],
            [
                'sku' => 'CON-002',
                'name' => 'Gáº¡c y táº¿ (GÃ³i 100 miáº¿ng)',
                'category' => 'consumable',
                'manufacturer' => 'Vina Cotton',
                'supplier_id' => $supplierIds[0] ?? null,
                'unit' => 'GÃ³i',
                'stock_qty' => 40,
                'min_stock' => 15,
                'reorder_point' => 25,
                'cost_price' => 45000,
                'sale_price' => 65000,
                'storage_location' => 'Ká»‡ D1',
                'branch_id' => $branchId,
            ],
            [
                'sku' => 'CON-003',
                'name' => 'GÄƒng tay nitrile (Há»™p 100 cÃ¡i)',
                'category' => 'consumable',
                'manufacturer' => 'Ansell',
                'supplier_id' => $supplierIds[0] ?? null,
                'unit' => 'Há»™p',
                'stock_qty' => 35,
                'min_stock' => 15,
                'reorder_point' => 20,
                'cost_price' => 180000,
                'sale_price' => 250000,
                'storage_location' => 'Ká»‡ E1',
                'branch_id' => $branchId,
            ],
            [
                'sku' => 'CON-004',
                'name' => 'Kháº©u trang y táº¿ 4 lá»›p (Há»™p 50 cÃ¡i)',
                'category' => 'consumable',
                'manufacturer' => '3M',
                'supplier_id' => $supplierIds[0] ?? null,
                'unit' => 'Há»™p',
                'stock_qty' => 45,
                'min_stock' => 20,
                'reorder_point' => 30,
                'cost_price' => 95000,
                'sale_price' => 140000,
                'storage_location' => 'Ká»‡ E1',
                'branch_id' => $branchId,
            ],
            [
                'sku' => 'CON-005',
                'name' => 'Xilanh 5ml (Há»™p 100 cÃ¡i)',
                'category' => 'consumable',
                'manufacturer' => 'Terumo',
                'supplier_id' => $supplierIds[0] ?? null,
                'unit' => 'Há»™p',
                'stock_qty' => 20,
                'min_stock' => 8,
                'reorder_point' => 12,
                'cost_price' => 250000,
                'sale_price' => 350000,
                'storage_location' => 'Tá»§ D3',
                'branch_id' => $branchId,
            ],
            [
                'sku' => 'CON-006',
                'name' => 'Kim tiÃªm 27G (Há»™p 100 cÃ¡i)',
                'category' => 'consumable',
                'manufacturer' => 'Terumo',
                'supplier_id' => $supplierIds[0] ?? null,
                'unit' => 'Há»™p',
                'stock_qty' => 18,
                'min_stock' => 10,
                'reorder_point' => 15,
                'cost_price' => 120000,
                'sale_price' => 180000,
                'storage_location' => 'Tá»§ D3',
                'branch_id' => $branchId,
            ],
            [
                'sku' => 'CON-007',
                'name' => 'Saliva ejector (TÃºi 100 cÃ¡i)',
                'category' => 'consumable',
                'manufacturer' => 'Dentsply',
                'supplier_id' => $supplierIds[1] ?? null,
                'unit' => 'TÃºi',
                'stock_qty' => 60,
                'min_stock' => 25,
                'reorder_point' => 40,
                'cost_price' => 150000,
                'sale_price' => 220000,
                'storage_location' => 'Ká»‡ F2',
                'branch_id' => $branchId,
            ],
            [
                'sku' => 'CON-008',
                'name' => 'Dental bib (Há»™p 500 táº¥m)',
                'category' => 'consumable',
                'manufacturer' => 'Medicom',
                'supplier_id' => $supplierIds[0] ?? null,
                'unit' => 'Há»™p',
                'stock_qty' => 12,
                'min_stock' => 5,
                'reorder_point' => 8,
                'cost_price' => 320000,
                'sale_price' => 450000,
                'storage_location' => 'Ká»‡ F1',
                'branch_id' => $branchId,
            ],

            // EQUIPMENT (5 items)
            [
                'sku' => 'EQP-001',
                'name' => 'Handpiece tá»‘c Ä‘á»™ cao NSK',
                'category' => 'equipment',
                'manufacturer' => 'NSK',
                'supplier_id' => $supplierIds[2] ?? null,
                'unit' => 'CÃ¡i',
                'stock_qty' => 3,
                'min_stock' => 1,
                'reorder_point' => 2,
                'cost_price' => 8500000,
                'sale_price' => 12000000,
                'storage_location' => 'Tá»§ thiáº¿t bá»‹ A',
                'branch_id' => $branchId,
            ],
            [
                'sku' => 'EQP-002',
                'name' => 'MÃ¡y cáº¡o vÃ´i rÄƒng Ultrasonic',
                'category' => 'equipment',
                'manufacturer' => 'EMS',
                'supplier_id' => $supplierIds[2] ?? null,
                'unit' => 'CÃ¡i',
                'stock_qty' => 2,
                'min_stock' => 1,
                'reorder_point' => 1,
                'cost_price' => 15000000,
                'sale_price' => 22000000,
                'storage_location' => 'Tá»§ thiáº¿t bá»‹ A',
                'branch_id' => $branchId,
            ],
            [
                'sku' => 'EQP-003',
                'name' => 'ÄÃ¨n quang trÃ¹ng há»£p LED',
                'category' => 'equipment',
                'manufacturer' => '3M ESPE',
                'supplier_id' => $supplierIds[0] ?? null,
                'unit' => 'CÃ¡i',
                'stock_qty' => 4,
                'min_stock' => 2,
                'reorder_point' => 3,
                'cost_price' => 4500000,
                'sale_price' => 6500000,
                'storage_location' => 'Tá»§ thiáº¿t bá»‹ B',
                'branch_id' => $branchId,
            ],
            [
                'sku' => 'EQP-004',
                'name' => 'Suction tip dÃ¹ng má»™t láº§n (TÃºi 50 cÃ¡i)',
                'category' => 'equipment',
                'manufacturer' => 'Dentsply',
                'supplier_id' => $supplierIds[1] ?? null,
                'unit' => 'TÃºi',
                'stock_qty' => 25,
                'min_stock' => 10,
                'reorder_point' => 15,
                'cost_price' => 280000,
                'sale_price' => 400000,
                'storage_location' => 'Ká»‡ G1',
                'branch_id' => $branchId,
            ],
            [
                'sku' => 'EQP-005',
                'name' => 'Dental mirror (Há»™p 12 cÃ¡i)',
                'category' => 'equipment',
                'manufacturer' => 'ASA Dental',
                'supplier_id' => $supplierIds[0] ?? null,
                'unit' => 'Há»™p',
                'stock_qty' => 8,
                'min_stock' => 3,
                'reorder_point' => 5,
                'cost_price' => 450000,
                'sale_price' => 650000,
                'storage_location' => 'Tá»§ dá»¥ng cá»¥ C',
                'branch_id' => $branchId,
            ],

            // DENTAL_MATERIAL (7 items)
            [
                'sku' => 'MAT-001',
                'name' => 'Composite resin A2 (Xilanh 4g)',
                'category' => 'dental_material',
                'manufacturer' => '3M ESPE',
                'supplier_id' => $supplierIds[0] ?? null,
                'unit' => 'Xilanh',
                'stock_qty' => 45,
                'min_stock' => 15,
                'reorder_point' => 25,
                'cost_price' => 380000,
                'sale_price' => 550000,
                'storage_location' => 'Tá»§ láº¡nh váº­t liá»‡u',
                'branch_id' => $branchId,
            ],
            [
                'sku' => 'MAT-002',
                'name' => 'Glass ionomer cement (Lá» 15g)',
                'category' => 'dental_material',
                'manufacturer' => 'GC Corporation',
                'supplier_id' => $supplierIds[1] ?? null,
                'unit' => 'Lá»',
                'stock_qty' => 30,
                'min_stock' => 10,
                'reorder_point' => 18,
                'cost_price' => 420000,
                'sale_price' => 600000,
                'storage_location' => 'Tá»§ váº­t liá»‡u A',
                'branch_id' => $branchId,
            ],
            [
                'sku' => 'MAT-003',
                'name' => 'Dental cement (Bá»™ 35g bá»™t + 15ml dung dá»‹ch)',
                'category' => 'dental_material',
                'manufacturer' => 'Dentsply',
                'supplier_id' => $supplierIds[1] ?? null,
                'unit' => 'Bá»™',
                'stock_qty' => 22,
                'min_stock' => 8,
                'reorder_point' => 12,
                'cost_price' => 290000,
                'sale_price' => 420000,
                'storage_location' => 'Tá»§ váº­t liá»‡u A',
                'branch_id' => $branchId,
            ],
            [
                'sku' => 'MAT-004',
                'name' => 'Impression material Alginate (TÃºi 453g)',
                'category' => 'dental_material',
                'manufacturer' => 'Zhermack',
                'supplier_id' => $supplierIds[1] ?? null,
                'unit' => 'TÃºi',
                'stock_qty' => 18,
                'min_stock' => 8,
                'reorder_point' => 12,
                'cost_price' => 320000,
                'sale_price' => 480000,
                'storage_location' => 'Tá»§ váº­t liá»‡u B',
                'branch_id' => $branchId,
            ],
            [
                'sku' => 'MAT-005',
                'name' => 'Bonding agent (Chai 5ml)',
                'category' => 'dental_material',
                'manufacturer' => '3M ESPE',
                'supplier_id' => $supplierIds[0] ?? null,
                'unit' => 'Chai',
                'stock_qty' => 28,
                'min_stock' => 10,
                'reorder_point' => 15,
                'cost_price' => 680000,
                'sale_price' => 950000,
                'storage_location' => 'Tá»§ láº¡nh váº­t liá»‡u',
                'branch_id' => $branchId,
            ],
            [
                'sku' => 'MAT-006',
                'name' => 'Etching gel 37% (Xilanh 3ml)',
                'category' => 'dental_material',
                'manufacturer' => 'Bisco',
                'supplier_id' => $supplierIds[0] ?? null,
                'unit' => 'Xilanh',
                'stock_qty' => 35,
                'min_stock' => 12,
                'reorder_point' => 20,
                'cost_price' => 180000,
                'sale_price' => 280000,
                'storage_location' => 'Tá»§ váº­t liá»‡u A',
                'branch_id' => $branchId,
            ],
            [
                'sku' => 'MAT-007',
                'name' => 'Temporary filling material (Há»™p 30g)',
                'category' => 'dental_material',
                'manufacturer' => 'Dentsply',
                'supplier_id' => $supplierIds[1] ?? null,
                'unit' => 'Há»™p',
                'stock_qty' => 40,
                'min_stock' => 15,
                'reorder_point' => 25,
                'cost_price' => 220000,
                'sale_price' => 350000,
                'storage_location' => 'Tá»§ váº­t liá»‡u B',
                'branch_id' => $branchId,
            ],
        ];

        foreach ($materials as $materialData) {
            Material::firstOrCreate(
                ['sku' => $materialData['sku']],
                $materialData
            );
        }

        $this->command->info('âœ… Created or updated 25 materials across 4 categories');

        // Create batches with varied expiry dates
        $materialIds = Material::pluck('id', 'sku')->toArray();
        
        $batches = [
            // EXPIRED BATCHES (5 items) - Háº¾T Háº N
            ['material_sku' => 'MED-001', 'batch_number' => 'LOT-2023-001', 'expiry_date' => now()->subDays(45), 'quantity' => 0, 'status' => 'expired'],
            ['material_sku' => 'CON-003', 'batch_number' => 'LOT-2023-015', 'expiry_date' => now()->subDays(30), 'quantity' => 0, 'status' => 'expired'],
            ['material_sku' => 'MAT-001', 'batch_number' => 'LOT-2023-022', 'expiry_date' => now()->subDays(15), 'quantity' => 0, 'status' => 'expired'],
            ['material_sku' => 'MED-005', 'batch_number' => 'LOT-2023-008', 'expiry_date' => now()->subDays(10), 'quantity' => 0, 'status' => 'expired'],
            ['material_sku' => 'CON-004', 'batch_number' => 'LOT-2023-019', 'expiry_date' => now()->subDays(5), 'quantity' => 0, 'status' => 'expired'],

            // EXPIRING SOON (< 30 days) (10 items) - Sáº®P Háº¾T Háº N
            ['material_sku' => 'MED-002', 'batch_number' => 'LOT-2025-002', 'expiry_date' => now()->addDays(3), 'quantity' => 20, 'status' => 'active'],
            ['material_sku' => 'MED-003', 'batch_number' => 'LOT-2025-003', 'expiry_date' => now()->addDays(5), 'quantity' => 50, 'status' => 'active'],
            ['material_sku' => 'CON-001', 'batch_number' => 'LOT-2025-010', 'expiry_date' => now()->addDays(7), 'quantity' => 100, 'status' => 'active'],
            ['material_sku' => 'MAT-002', 'batch_number' => 'LOT-2025-025', 'expiry_date' => now()->addDays(10), 'quantity' => 30, 'status' => 'active'],
            ['material_sku' => 'MED-004', 'batch_number' => 'LOT-2025-004', 'expiry_date' => now()->addDays(12), 'quantity' => 80, 'status' => 'active'],
            ['material_sku' => 'CON-002', 'batch_number' => 'LOT-2025-011', 'expiry_date' => now()->addDays(15), 'quantity' => 90, 'status' => 'active'],
            ['material_sku' => 'MAT-005', 'batch_number' => 'LOT-2025-029', 'expiry_date' => now()->addDays(18), 'quantity' => 25, 'status' => 'active'],
            ['material_sku' => 'CON-005', 'batch_number' => 'LOT-2025-013', 'expiry_date' => now()->addDays(22), 'quantity' => 60, 'status' => 'active'],
            ['material_sku' => 'MAT-006', 'batch_number' => 'LOT-2025-030', 'expiry_date' => now()->addDays(25), 'quantity' => 40, 'status' => 'active'],
            ['material_sku' => 'CON-006', 'batch_number' => 'LOT-2025-014', 'expiry_date' => now()->addDays(28), 'quantity' => 70, 'status' => 'active'],

            // NORMAL BATCHES (> 30 days) (20 items) - CÃ’N Háº N
            ['material_sku' => 'MED-001', 'batch_number' => 'LOT-2025-001', 'expiry_date' => now()->addDays(60), 'quantity' => 150, 'status' => 'active'],
            ['material_sku' => 'MED-002', 'batch_number' => 'LOT-2025-002B', 'expiry_date' => now()->addDays(90), 'quantity' => 100, 'status' => 'active'],
            ['material_sku' => 'MED-003', 'batch_number' => 'LOT-2025-003B', 'expiry_date' => now()->addDays(120), 'quantity' => 200, 'status' => 'active'],
            ['material_sku' => 'MED-004', 'batch_number' => 'LOT-2025-004B', 'expiry_date' => now()->addDays(150), 'quantity' => 250, 'status' => 'active'],
            ['material_sku' => 'MED-005', 'batch_number' => 'LOT-2025-005', 'expiry_date' => now()->addDays(180), 'quantity' => 300, 'status' => 'active'],
            ['material_sku' => 'CON-001', 'batch_number' => 'LOT-2025-010B', 'expiry_date' => now()->addDays(240), 'quantity' => 500, 'status' => 'active'],
            ['material_sku' => 'CON-002', 'batch_number' => 'LOT-2025-011B', 'expiry_date' => now()->addDays(270), 'quantity' => 400, 'status' => 'active'],
            ['material_sku' => 'CON-003', 'batch_number' => 'LOT-2025-012', 'expiry_date' => now()->addDays(300), 'quantity' => 350, 'status' => 'active'],
            ['material_sku' => 'CON-004', 'batch_number' => 'LOT-2025-013B', 'expiry_date' => now()->addDays(330), 'quantity' => 450, 'status' => 'active'],
            ['material_sku' => 'CON-005', 'batch_number' => 'LOT-2025-014B', 'expiry_date' => now()->addDays(365), 'quantity' => 200, 'status' => 'active'],
            ['material_sku' => 'CON-006', 'batch_number' => 'LOT-2025-015', 'expiry_date' => now()->addDays(400), 'quantity' => 180, 'status' => 'active'],
            ['material_sku' => 'CON-007', 'batch_number' => 'LOT-2025-016', 'expiry_date' => now()->addDays(450), 'quantity' => 600, 'status' => 'active'],
            ['material_sku' => 'CON-008', 'batch_number' => 'LOT-2025-017', 'expiry_date' => now()->addDays(500), 'quantity' => 120, 'status' => 'active'],
            ['material_sku' => 'MAT-001', 'batch_number' => 'LOT-2025-026', 'expiry_date' => now()->addDays(540), 'quantity' => 450, 'status' => 'active'],
            ['material_sku' => 'MAT-002', 'batch_number' => 'LOT-2025-027', 'expiry_date' => now()->addDays(600), 'quantity' => 300, 'status' => 'active'],
            ['material_sku' => 'MAT-003', 'batch_number' => 'LOT-2025-028', 'expiry_date' => now()->addDays(650), 'quantity' => 220, 'status' => 'active'],
            ['material_sku' => 'MAT-004', 'batch_number' => 'LOT-2025-029B', 'expiry_date' => now()->addDays(700), 'quantity' => 180, 'status' => 'active'],
            ['material_sku' => 'MAT-005', 'batch_number' => 'LOT-2025-030B', 'expiry_date' => now()->addDays(730), 'quantity' => 280, 'status' => 'active'],
            ['material_sku' => 'MAT-006', 'batch_number' => 'LOT-2025-031', 'expiry_date' => now()->addDays(800), 'quantity' => 350, 'status' => 'active'],
            ['material_sku' => 'MAT-007', 'batch_number' => 'LOT-2025-032', 'expiry_date' => now()->addDays(900), 'quantity' => 400, 'status' => 'active'],
        ];

        $batchCount = 0;
        foreach ($batches as $batchData) {
            $materialId = $materialIds[$batchData['material_sku']] ?? null;
            if (!$materialId) continue;

            MaterialBatch::create([
                'material_id' => $materialId,
                'batch_number' => $batchData['batch_number'],
                'expiry_date' => $batchData['expiry_date'],
                'quantity' => $batchData['quantity'],
                'purchase_price' => rand(50000, 500000),
                'received_date' => now()->subDays(rand(1, 90)),
                'supplier_id' => $supplierIds[array_rand($supplierIds)] ?? null,
                'status' => $batchData['status'],
                'notes' => $batchData['status'] === 'expired' ? 'ÄÃ£ háº¿t háº¡n - cáº§n xá»­ lÃ½' : null,
            ]);
            $batchCount++;
        }

        $this->command->info("âœ… Created {$batchCount} batches (5 expired, 10 expiring soon, 20 normal)");
        $this->command->info('ðŸŽ‰ Inventory seeding completed successfully!');
    }
}
